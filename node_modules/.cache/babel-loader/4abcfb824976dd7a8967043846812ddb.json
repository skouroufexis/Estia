{"ast":null,"code":"import _slicedToArray from\"/Users/stavros/Documents/web/estia/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";// import './main.css';\nimport{useState,useEffect}from'react';import React from\"react\";import'./itemBalance.css';import{BrowserRouter as Router,Link,useParams}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ItemBalance(){var _useParams=useParams(),category=_useParams.category,subcategory=_useParams.subcategory,item=_useParams.item;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),total=_useState2[0],getTotal=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),minimum=_useState4[0],setMinimum=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),duration=_useState6[0],setDuration=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),dateAdded=_useState8[0],setDateAdded=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),transaction=_useState10[0],getTransaction=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),modalMessage=_useState12[0],setModalMessage=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),notifications=_useState14[0],setNotifications=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),autolist=_useState16[0],setAutoList=_useState16[1];var _useState17=useState(''),_useState18=_slicedToArray(_useState17,2),isFavourites=_useState18[0],setFavourites=_useState18[1];var household=localStorage.getItem('household');function fTotal(n){if(total+n>=0){getTotal(total+n);getTransaction(transaction+n);}}function showModal(n){var modal=document.getElementById('modal');var subMenuButtons=document.getElementsByClassName('submenu-button');if(n==0){toggleNotifications('off',function(result){if(result==true){setModalMessage('Notifications are disabled for this item');toggleModal();}});}if(n==1){toggleNotifications('on',function(result){if(result==true){setModalMessage('Notifications are enabled for this item');toggleModal();}});}if(n==2){toggleAutolist('off',function(result){if(result==true){setModalMessage('Auto add-to-shopping-list is disabled for this item');toggleModal();}});}if(n==3){toggleAutolist('on',function(result){if(result==true){setModalMessage('Auto add-to-shopping-list is enabled for this item');toggleModal();}});}if(n==4){toggleFavourites('off',function(result){if(result==true){setModalMessage('Item removed from favourites');toggleModal();}});}if(n==5){toggleFavourites('on',function(result){if(result==true){setModalMessage('Item added to favourites');toggleModal();}});}function toggleModal(){modal.style.display='flex';setTimeout(function(){modal.style.opacity='1';modal.style.transform='translateY(0)';disableButtons();setTimeout(function(){modal.style.opacity='0';modal.style.transform='translateY(-10px)';enableButtons();},1500);setTimeout(function(){modal.style.display='none';},2000);},100);}function toggleNotifications(n,callback){//send request to toggle notifications for specific item      \nvar data=\"household=\".concat(household,\"&category=\").concat(category,\"&subcategory=\").concat(subcategory,\"&item=\").concat(item,\"&notifications=\").concat(n);var request=new XMLHttpRequest();request.open('POST','http://localhost:8080/api/putNotifications');request.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");request.send(data);request.onload=function(){if(this.status==200){getItemData();callback(true);}};}function toggleAutolist(l,callback){//send request to toggle autolist for specific item      \nvar data=\"household=\".concat(household,\"&category=\").concat(category,\"&subcategory=\").concat(subcategory,\"&item=\").concat(item,\"&autolist=\").concat(l,\"&total=\").concat(total,\"&minimum=\").concat(minimum);var request=new XMLHttpRequest();request.open('POST','http://localhost:8080/api/putAutolist');request.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");request.send(data);request.onload=function(){if(this.status==200){getItemData();callback(true);}};}function toggleFavourites(f,callback){//send request to toggle favourites for specific item      \nvar data=\"household=\".concat(household,\"&category=\").concat(category,\"&subcategory=\").concat(subcategory,\"&item=\").concat(item,\"&favourites=\").concat(f);var request=new XMLHttpRequest();request.open('POST','http://localhost:8080/api/putFavourites');request.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");request.send(data);request.onload=function(){if(this.status==200){getItemData();callback(true);}};}}function disableButtons(){document.getElementById('submenu-container').style.display='none';}function enableButtons(){document.getElementById('submenu-container').style.display='block';}function getItemData(){//get the stock total for this item\nvar household=localStorage.getItem('household');var path='http://localhost:8080/api/getBalance?household='+household+'&category='+category+'&subcategory='+subcategory+'&item='+item;var xhttp=new XMLHttpRequest();xhttp.open(\"GET\",path);xhttp.send();xhttp.onload=function(){var response=JSON.parse(this.responseText);var total=parseInt(response.total);var minimum=parseInt(response.minimum);var duration=response.duration;if(duration!='No expiration'){duration=parseInt(duration);}var notifications=response.notifications;var autolist=response.autolist;var favourites=response.favourites;var dateAdded=response.dateAdded;setNotifications(notifications);setAutoList(autolist);setFavourites(favourites);setDuration(duration);getTotal(total);setMinimum(minimum);setDateAdded(dateAdded);};}useEffect(function(){getItemData();},[]);return/*#__PURE__*/_jsxs(\"main\",{className:\"container top1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(Link,{to:'/stock-category/'+category+'/'+subcategory,className:\"col-12\",children:/*#__PURE__*/_jsx(\"i\",{class:\"fas fa-caret-left\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"row top1\",id:\"submenu-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 green\",children:[/*#__PURE__*/_jsxs(\"b\",{children:[\" \",item,\" \"]}),/*#__PURE__*/_jsx(\"span\",{className:\"lightgrey\",children:\" |stock\"}),notifications=='on'&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"left2 green submenu-button\",title:\"Notifications are enabled for this item\",onClick:function onClick(){showModal(0);},children:/*#__PURE__*/_jsx(\"small\",{class:\"fas fa-bell\"})}),notifications=='off'&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"left1 lightgrey submenu-button\",title:\"Notifications are disabled for this item\",onClick:function onClick(){showModal(1);},children:/*#__PURE__*/_jsx(\"small\",{class:\"fas fa-bell-slash\"})}),autolist=='on'&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"left1 green submenu-button\",title:\"Auto add-to-shopping-list is enabled for this item\",onClick:function onClick(){showModal(2);},children:/*#__PURE__*/_jsx(\"small\",{class:\"fas fa-tasks\"})}),autolist=='off'&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"left1 lightgrey submenu-button\",title:\"Auto add-to-shopping-list is disabled for this item\",onClick:function onClick(){showModal(3);},children:/*#__PURE__*/_jsx(\"small\",{class:\"fas fa-tasks\"})}),isFavourites=='on'&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"left1 green submenu-button\",title:\"Click to remove item from favourites\",onClick:function onClick(){showModal(4);},children:/*#__PURE__*/_jsx(\"small\",{class:\"fas fa-star\"})}),isFavourites=='off'&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"left1 lightgrey submenu-button\",title:\"Click to add item to favourites\",onClick:function onClick(){showModal(5);},children:/*#__PURE__*/_jsx(\"small\",{class:\"fas fa-star\"})})]})}),/*#__PURE__*/_jsxs(\"form\",{method:\"post\",action:\"http://localhost:8080/api/putBalance\",className:\"row top1\",id:\"form_ItemBalance\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"hidden\",type:\"text\",name:\"household\",id:\"household\",value:household}),/*#__PURE__*/_jsx(\"input\",{className:\"hidden\",type:\"text\",name:\"item\",id:\"item\",value:item}),/*#__PURE__*/_jsx(\"input\",{className:\"hidden\",type:\"text\",name:\"category\",id:\"category\",value:category}),/*#__PURE__*/_jsx(\"input\",{className:\"hidden\",type:\"text\",name:\"subcategory\",id:\"subcategory\",value:subcategory}),/*#__PURE__*/_jsx(\"input\",{className:\"hidden\",type:\"text\",name:\"autolist\",id:\"autolist\",value:autolist}),/*#__PURE__*/_jsx(\"input\",{className:\"hidden\",type:\"text\",name:\"deleted\",id:\"deleted\",value:\"false\"}),/*#__PURE__*/_jsx(\"input\",{className:\"hidden\",type:\"text\",name:\"transaction\",id:\"transaction\",value:transaction}),/*#__PURE__*/_jsx(\"input\",{className:\"hidden\",type:\"text\",name:\"duration\",id:\"duration\",value:duration}),/*#__PURE__*/_jsx(\"input\",{className:\"hidden\",type:\"text\",name:\"dateAdded\",id:\"dateAdded\",value:dateAdded}),/*#__PURE__*/_jsxs(\"label\",{for:\"total\",className:\"col-12 grey\",children:[\"Total in stock\",/*#__PURE__*/_jsx(\"input\",{className:\"hidden\",type:\"text\",name:\"total\",id:\"total\",value:total}),/*#__PURE__*/_jsx(\"input\",{className:\"hidden\",type:\"text\",name:\"minimum\",id:\"minimum\",value:minimum}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 black\",children:[\" \",total]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"top1\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn  button-secondary2\",onClick:function onClick(){fTotal(-5);},children:\"-5\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn  button-secondary2 left1\",onClick:function onClick(){fTotal(-1);},children:\"-1\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn  button-secondary left1\",onClick:function onClick(){fTotal(1);},children:\"+1\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn  button-secondary left1\",onClick:function onClick(){fTotal(5);},children:\"+5\"})]}),transaction!=0&&/*#__PURE__*/_jsx(\"div\",{className:\"top2\",children:/*#__PURE__*/_jsx(\"button\",{className:\"col-3 col-lg-1  btn btn-primary\",children:/*#__PURE__*/_jsx(\"b\",{children:\"Save\"})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modals  vertical-centre centre\",id:\"modal\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:/*#__PURE__*/_jsx(\"b\",{children:/*#__PURE__*/_jsx(\"p\",{children:modalMessage})})})})]});}export default ItemBalance;","map":{"version":3,"sources":["/Users/stavros/Documents/web/estia/src/ItemBalance.js"],"names":["useState","useEffect","React","BrowserRouter","Router","Link","useParams","ItemBalance","category","subcategory","item","total","getTotal","minimum","setMinimum","duration","setDuration","dateAdded","setDateAdded","transaction","getTransaction","modalMessage","setModalMessage","notifications","setNotifications","autolist","setAutoList","isFavourites","setFavourites","household","localStorage","getItem","fTotal","n","showModal","modal","document","getElementById","subMenuButtons","getElementsByClassName","toggleNotifications","result","toggleModal","toggleAutolist","toggleFavourites","style","display","setTimeout","opacity","transform","disableButtons","enableButtons","callback","data","request","XMLHttpRequest","open","setRequestHeader","send","onload","status","getItemData","l","f","path","xhttp","response","JSON","parse","responseText","parseInt","favourites"],"mappings":"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","sourcesContent":["\n// import './main.css';\n\nimport  { useState,useEffect } from 'react';\nimport React from \"react\";\nimport './itemBalance.css';\n\nimport {\n  BrowserRouter as Router,    \n  Link,useParams\n} from \"react-router-dom\";\n\nfunction ItemBalance() {\n\n  let { category,subcategory,item } = useParams();\n  \n  const [total, getTotal] = useState(0);  \n  const [minimum, setMinimum] = useState(0); \n  const [duration, setDuration] = useState(0);  \n  const [dateAdded, setDateAdded]=useState('');\n  const [transaction,getTransaction]=useState(0);\n  const [modalMessage, setModalMessage]=useState('');\n  const [notifications, setNotifications]=useState('');\n  const [autolist,setAutoList]=useState('');\n  const [isFavourites,setFavourites]=useState('');\n\n\n  let household=localStorage.getItem('household');\n  \n  function fTotal(n){\n    if((total+n)>=0){\n      getTotal(total+n);\n      getTransaction(transaction+n);\n    }\n  }\n\n function showModal(n){\n    let modal=document.getElementById('modal'); \n       \n    let subMenuButtons=document.getElementsByClassName('submenu-button');\n    if(n==0){               \n      toggleNotifications('off',function(result){\n          if(result==true){\n            setModalMessage('Notifications are disabled for this item'); \n            toggleModal();            \n          }\n        });\n\n    }\n    if (n==1){\n         \n      toggleNotifications('on',function(result){\n        if(result==true){\n          setModalMessage('Notifications are enabled for this item');\n          toggleModal();            \n        }\n      });\n      \n    }\n    if (n==2){\n\n      toggleAutolist('off',function(result){\n        if(result==true){\n          setModalMessage('Auto add-to-shopping-list is disabled for this item');\n          toggleModal();            \n        }\n      });\n      \n    }\n    if (n==3){\n      toggleAutolist('on',function(result){\n        if(result==true){\n          setModalMessage('Auto add-to-shopping-list is enabled for this item');\n          toggleModal();            \n        }\n      });\n    }\n\n    if (n==4){\n\n      toggleFavourites('off',function(result){\n        if(result==true){\n          setModalMessage('Item removed from favourites');\n          toggleModal();            \n        }\n      });            \n    }\n\n    if (n==5){\n      toggleFavourites('on',function(result){\n        if(result==true){\n          setModalMessage('Item added to favourites');\n          toggleModal();            \n        }\n      });   \n    }\n\n    function toggleModal(){\n      modal.style.display='flex';\n      setTimeout(() => {\n        modal.style.opacity='1';\n        modal.style.transform='translateY(0)';\n        disableButtons();  \n        setTimeout(() => {\n          modal.style.opacity='0';   \n          modal.style.transform='translateY(-10px)';  \n          enableButtons();             \n        }, 1500); \n        setTimeout(() => {\n          modal.style.display='none';   \n        }, 2000);               \n      }, 100);\n    }\n\n\n    function toggleNotifications(n,callback){         \n      //send request to toggle notifications for specific item      \n      let data=`household=${household}&category=${category}&subcategory=${subcategory}&item=${item}&notifications=${n}`;\n\n      let request=new XMLHttpRequest();                    \n        request.open('POST','http://localhost:8080/api/putNotifications');  \n        request.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n        request.send(data);\n\n        request.onload = function (){                    \n            if(this.status==200){\n              getItemData();\n              callback(true);\n            }\n        }\n    }\n\n    function toggleAutolist(l,callback){\n      //send request to toggle autolist for specific item      \n      let data=`household=${household}&category=${category}&subcategory=${subcategory}&item=${item}&autolist=${l}&total=${total}&minimum=${minimum}`;\n\n      let request=new XMLHttpRequest();                    \n        request.open('POST','http://localhost:8080/api/putAutolist');  \n        request.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n        request.send(data);\n\n        request.onload = function (){                    \n            if(this.status==200){\n              getItemData();\n              callback(true);\n            }\n        }\n    }\n\n    function toggleFavourites(f,callback){\n      //send request to toggle favourites for specific item      \n      let data=`household=${household}&category=${category}&subcategory=${subcategory}&item=${item}&favourites=${f}`;\n\n      let request=new XMLHttpRequest();                    \n        request.open('POST','http://localhost:8080/api/putFavourites');  \n        request.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n        request.send(data);\n\n        request.onload = function (){                    \n            if(this.status==200){\n              getItemData();\n              callback(true);\n            }\n        }\n    }\n\n\n    \n\n } \n\n\n function disableButtons(){\n    \n  document.getElementById('submenu-container').style.display='none';\n }\n\n function enableButtons(){\n  document.getElementById('submenu-container').style.display='block';\n }\n\n\n function getItemData(){\n\n    //get the stock total for this item\n    let household=localStorage.getItem('household');\n    let path='http://localhost:8080/api/getBalance?household='+\n        household+'&category='+category+'&subcategory='+subcategory+\n        '&item='+item;\n    \n    var xhttp = new XMLHttpRequest();    \n    xhttp.open(\"GET\", path);\n    xhttp.send();\n\n    xhttp.onload = function() {\n\n      let response=JSON.parse(this.responseText);\n      let total=parseInt(response.total);\n      let minimum=parseInt(response.minimum);\n      let duration=response.duration;\n      if(duration!='No expiration'){\n        duration=parseInt(duration);\n      }      \n      let notifications=response.notifications;\n      let autolist=response.autolist;\n      let favourites=response.favourites;\n      let dateAdded=response.dateAdded;\n\n        \n      setNotifications(notifications);\n      setAutoList(autolist);\n      setFavourites(favourites);\n      setDuration(duration);\n      getTotal(total);\n      setMinimum(minimum);\n      setDateAdded(dateAdded);\n    };\n\n }\n\n\n  useEffect(() => {\n   \n  getItemData();  \n    },[]);\n\n  return (        \n    <main className='container top1'>\n\n        <div className='row'>\n              <Link to={'/stock-category/'+category+'/'+subcategory} className='col-12'><i class=\"fas fa-caret-left\"></i></Link>              \n        </div>\n        \n        <div className='row top1' id='submenu-container'> \n            <div className='col-12 green'><b> {item} </b><span className='lightgrey'> |stock</span>\n              {\n                notifications=='on' &&\n                <button type='button' className='left2 green submenu-button' title='Notifications are enabled for this item' onClick={()=>{\n                  showModal(0)\n                  }} >\n                <small class=\"fas fa-bell\"></small>\n              </button>   \n              \n              }\n\n              {\n                notifications=='off' &&\n                <button type='button' className='left1 lightgrey submenu-button' title='Notifications are disabled for this item' onClick={()=>{\n                showModal(1)\n                 }}>\n                 <small class=\"fas fa-bell-slash\"></small>\n              </button>   }  \n\n              { autolist=='on' &&\n                <button type='button' className='left1 green submenu-button' title='Auto add-to-shopping-list is enabled for this item' onClick={()=>{\n                showModal(2)\n                }}>\n                <small class=\"fas fa-tasks\"></small>\n              </button>      }\n\n              { autolist=='off' &&\n                <button type='button' className='left1 lightgrey submenu-button' title='Auto add-to-shopping-list is disabled for this item' onClick={()=>{\n                showModal(3)\n                }}>\n                <small class=\"fas fa-tasks\"></small>\n              </button>  }\n\n               {  isFavourites=='on' &&\n                 <button type='button' className='left1 green submenu-button' title='Click to remove item from favourites' onClick={()=>{\n                showModal(4)\n                }}><small class=\"fas fa-star\"></small>\n              </button>}\n              \n              { \n                isFavourites=='off' &&\n                <button type='button' className='left1 lightgrey submenu-button' title='Click to add item to favourites' onClick={()=>{\n                showModal(5)\n               }}><small class=\"fas fa-star\"></small>\n              </button>   }                  \n            </div>\n            \n              \n            \n        </div>\n\n        <form method='post' action='http://localhost:8080/api/putBalance' className='row top1' id='form_ItemBalance'>\n            <input className='hidden' type='text' name='household' id='household' value={household}></input>  \n            <input className='hidden' type='text' name='item' id='item' value={item}></input>\n            <input className='hidden' type='text' name='category' id='category' value={category}></input>\n            <input className='hidden' type='text' name='subcategory' id='subcategory' value={subcategory}></input>\n            <input className='hidden' type='text' name='autolist' id='autolist' value={autolist}></input>  \n            <input className='hidden' type='text' name='deleted' id='deleted' value='false'></input>\n            <input className='hidden' type='text' name='transaction' id='transaction' value={transaction}></input>\n            <input className='hidden' type='text' name='duration' id='duration' value={duration}></input>  \n            <input className='hidden' type='text' name='dateAdded' id='dateAdded' value={dateAdded}></input>  \n\n            <label for='total' className='col-12 grey'>Total in stock\n                <input className='hidden' type='text' name='total' id='total' value={total}></input>\n                <input className='hidden' type='text' name='minimum' id='minimum' value={minimum}></input>\n                <div className='col-12 black'> {total}</div>\n            </label>      \n\n            <div className='top1'>\n                    <button type='button' className='btn  button-secondary2' onClick={()=>{fTotal(-5)}}>-5</button>\n                    <button type='button' className='btn  button-secondary2 left1'  onClick={()=>{fTotal(-1)}}>-1</button>                        \n                    <button type='button' className='btn  button-secondary left1'  onClick={()=>{fTotal(1)}}>+1</button>\n                    <button type='button' className='btn  button-secondary left1'  onClick={()=>{fTotal(5)}}>+5</button>                                                            \n            </div>  \n\n            { transaction!=0 &&\n            <div className='top2'>                \n              <button  className='col-3 col-lg-1  btn btn-primary'><b>Save</b></button>\n            </div>   }           \n        </form>\n\n        \n        <div className='modals  vertical-centre centre' id='modal'>\n          <div className='col-12'>\n            <b><p>{modalMessage}</p></b>\n            \n          </div>\n        </div>\n        \n    </main>            \n  );\n}\n\nexport default ItemBalance;\n"]},"metadata":{},"sourceType":"module"}